From 1dab9010c9059fdd2440aa8fc9ac5418c2e822e2 Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Date: Thu, 28 Oct 2021 10:34:00 +0300
Subject: [PATCH 02/24] boot/dts: s32g3: Move GIC node into s32g398 device tree

commit 1dab9010c9059fdd2440aa8fc9ac5418c2e822e2 from
https://source.codeaurora.org/external/autobsps32/linux

Issue: ALB-8016
Upstream-Status: Pending 

Signed-off-by: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 .../boot/dts/freescale/fsl-s32g398a-emu.dts   | 20 -------------------
 .../boot/dts/freescale/fsl-s32g398a.dtsi      | 20 +++++++++++++++++++
 .../boot/dts/freescale/fsl-s32gxxxa-evb.dtsi  |  1 -
 3 files changed, 20 insertions(+), 21 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-s32g398a-emu.dts b/arch/arm64/boot/dts/freescale/fsl-s32g398a-emu.dts
index 0532d914d122..d2a5332cf722 100644
--- a/arch/arm64/boot/dts/freescale/fsl-s32g398a-emu.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-s32g398a-emu.dts
@@ -11,7 +11,6 @@
 /dts-v1/;
 #include "fsl-s32g398a.dtsi"
 
-/delete-node/ &gic;
 /delete-node/ &pci_shared_memory;
 /delete-node/ &scmi_shbuf;
 /delete-node/ &scmi;
@@ -23,25 +22,6 @@
 	chosen {
 		stdout-path = "serial1:115200n8";
 	};
-
-	gic: interrupt-controller@50800000 {
-		compatible = "arm,gic-v3";
-		#interrupt-cells = <3>;
-		#address-cells = <2>;
-		#size-cells = <2>;
-		interrupt-controller;
-		reg = <0 0x50800000 0 0x10000>,
-		      <0 0x50900000 0 0x200000>,
-		      <0 0x50400000 0 0x2000>,
-		      <0 0x50410000 0 0x2000>,
-		      <0 0x50420000 0 0x2000>;
-		interrupts = <1 9 0xf04>;
-
-		msi-controller;
-		/* GIC interrupts between 167 and 182 can be used as MBIs. */
-		mbi-ranges = <167 16>;
-	};
-
 };
 
 &uart0 {
diff --git a/arch/arm64/boot/dts/freescale/fsl-s32g398a.dtsi b/arch/arm64/boot/dts/freescale/fsl-s32g398a.dtsi
index 7475df090474..8b8ddc04075b 100644
--- a/arch/arm64/boot/dts/freescale/fsl-s32g398a.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-s32g398a.dtsi
@@ -11,7 +11,27 @@
 /dts-v1/;
 #include "fsl-s32g.dtsi"
 
+/delete-node/ &gic;
+
 / {
+	gic: interrupt-controller@50800000 {
+		compatible = "arm,gic-v3";
+		#interrupt-cells = <3>;
+		#address-cells = <2>;
+		#size-cells = <2>;
+		interrupt-controller;
+		reg = <0 0x50800000 0 0x10000>,
+		      <0 0x50900000 0 0x200000>,
+		      <0 0x50400000 0 0x2000>,
+		      <0 0x50410000 0 0x2000>,
+		      <0 0x50420000 0 0x2000>;
+		interrupts = <1 9 0xf04>;
+
+		msi-controller;
+		/* GIC interrupts between 167 and 182 can be used as MBIs. */
+		mbi-ranges = <167 16>;
+	};
+
 	mc_cgm6: mc_cgm6@4053C000 {
 		compatible = "fsl,s32gen1-mc_cgm6";
 		reg = <0x0 0x4053C000 0x0 0x3000>;
diff --git a/arch/arm64/boot/dts/freescale/fsl-s32gxxxa-evb.dtsi b/arch/arm64/boot/dts/freescale/fsl-s32gxxxa-evb.dtsi
index 143588cad47f..81a43e6f7b9c 100644
--- a/arch/arm64/boot/dts/freescale/fsl-s32gxxxa-evb.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-s32gxxxa-evb.dtsi
@@ -2,7 +2,6 @@
 /*
  * Copyright 2019-2021 NXP
  */
-#include "fsl-s32g.dtsi"
 #include <dt-bindings/gpio/gpio.h>
 #include <dt-bindings/pinctrl/s32g-pinctrl.h>
 
-- 
2.17.1

