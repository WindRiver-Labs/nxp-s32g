From 47eb200f8099c59a657d8d0ff494f67b903d9690 Mon Sep 17 00:00:00 2001
From: Bogdan Folea <bogdan.folea@nxp.com>
Date: Fri, 12 Nov 2021 09:14:49 +0200
Subject: [PATCH 20/24] crypto: hse: print info in human-readable format

commit 47eb200f8099c59a657d8d0ff494f67b903d9690 from
https://source.codeaurora.org/external/autobsps32/linux

Issue: ALB-8107
Upstream-Status: Pending 

Signed-off-by: Bogdan Folea <bogdan.folea@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/crypto/hse/hse-abi.h  | 12 ++++++++++++
 drivers/crypto/hse/hse-core.c | 11 +++++++----
 2 files changed, 19 insertions(+), 4 deletions(-)

diff --git a/drivers/crypto/hse/hse-abi.h b/drivers/crypto/hse/hse-abi.h
index 11bc8bad4347..499ae5bf8982 100644
--- a/drivers/crypto/hse/hse-abi.h
+++ b/drivers/crypto/hse/hse-abi.h
@@ -25,6 +25,18 @@
 #define HSE_MIN_RNG_SIZE    32ul /* minimum random number length */
 #define HSE_MAX_RNG_SIZE    2048ul /* maximum random number length */
 
+/**
+ * enum hse_fw_type - HSE firmware type
+ * @HSE_FW_STANDARD: standard firmware
+ * @HSE_FW_PREMIUM: premium firmware
+ * @HSE_FW_CUSTOM: custom firmware
+ */
+enum hse_fw_type {
+	HSE_FW_STANDARD = 0u,
+	HSE_FW_PREMIUM = 1u,
+	HSE_FW_CUSTOM = 8u,
+};
+
 /**
  * enum hse_status - HSE status
  * @HSE_STATUS_RNG_INIT_OK: RNG initialization successfully completed
diff --git a/drivers/crypto/hse/hse-core.c b/drivers/crypto/hse/hse-core.c
index d8cb633f1d71..dc674e13a7ab 100644
--- a/drivers/crypto/hse/hse-core.c
+++ b/drivers/crypto/hse/hse-core.c
@@ -185,7 +185,8 @@ static int hse_key_ring_init(struct device *dev, struct list_head *key_ring,
 		list_add_tail(&ring[i].entry, key_ring);
 	}
 
-	dev_dbg(dev, "key ring type 0x%02x: group id %d, size %d\n", type,
+	dev_dbg(dev, "%s key ring: group id %d, size %d\n",
+		type == HSE_KEY_TYPE_AES ? "aes" : "hmac",
 		group_id, group_size);
 
 	return 0;
@@ -854,9 +855,11 @@ static int hse_probe(struct platform_device *pdev)
 	if (unlikely(err))
 		goto err_probe_failed;
 
-	dev_info(dev, "firmware type %d, version %d.%d.%d\n",
-		 drv->firmware_version.fw_type, drv->firmware_version.major,
-		 drv->firmware_version.minor, drv->firmware_version.patch);
+	dev_info(dev, "%s firmware, version %d.%d.%d\n",
+		 drv->firmware_version.fw_type == 0 ? "standard" :
+		 (drv->firmware_version.fw_type == 1 ? "premium" : "custom"),
+		 drv->firmware_version.major, drv->firmware_version.minor,
+		 drv->firmware_version.patch);
 
 	/* interface fixup */
 	hse_fw_if_fixup(dev);
-- 
2.17.1

