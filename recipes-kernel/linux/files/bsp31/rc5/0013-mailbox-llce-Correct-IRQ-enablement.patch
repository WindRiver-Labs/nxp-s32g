From 7a960ab078db8940a66211a348064e50ca603751 Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Date: Fri, 5 Nov 2021 13:32:45 +0200
Subject: [PATCH 13/24] mailbox: llce: Correct IRQ enablement

commit 7a960ab078db8940a66211a348064e50ca603751 from
https://source.codeaurora.org/external/autobsps32/linux

Issue: ALB-7935
Upstream-Status: Pending 

Signed-off-by: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/mailbox/llce-mailbox.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/mailbox/llce-mailbox.c b/drivers/mailbox/llce-mailbox.c
index 9f08f980cdba..e85787696a45 100644
--- a/drivers/mailbox/llce-mailbox.c
+++ b/drivers/mailbox/llce-mailbox.c
@@ -701,11 +701,13 @@ static void enable_fifo_irq(void __iomem *fifo)
 {
 	void __iomem *status1 = LLCE_FIFO_STATUS1(fifo);
 	void __iomem *ier = LLCE_FIFO_IER(fifo);
+	u32 ier_val;
 
 	/* Clear interrupt status flags. */
 	writel(readl(status1), status1);
 	/* Enable interrupt */
-	writel(LLCE_FIFO_FNEMTY, ier);
+	ier_val = readl(ier) | LLCE_FIFO_FNEMTY;
+	writel(ier_val, ier);
 }
 
 static void disable_fifo_irq(void __iomem *fifo)
-- 
2.17.1

