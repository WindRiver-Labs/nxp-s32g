From 72a250e54f2c923f464e072fe75d3e1aefdc2b9e Mon Sep 17 00:00:00 2001
From: Larisa Grigore <larisa.grigore@nxp.com>
Date: Thu, 1 Jul 2021 11:05:27 +0300
Subject: [PATCH 01/18] s32g: Remove DDR frequency for S32G274A Rev 1

Upstream-Status: Pending

Issue: ALB-7394
Signed-off-by: Larisa Grigore <larisa.grigore@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/nxp/s32g/clk/early_clocks.c            | 17 ++++-------------
 include/dt-bindings/clock/s32gen1-clock-freq.h |  6 ++----
 2 files changed, 6 insertions(+), 17 deletions(-)

diff --git a/drivers/nxp/s32g/clk/early_clocks.c b/drivers/nxp/s32g/clk/early_clocks.c
index 34bac1b78..5f82c0663 100644
--- a/drivers/nxp/s32g/clk/early_clocks.c
+++ b/drivers/nxp/s32g/clk/early_clocks.c
@@ -201,15 +201,6 @@ int s32g_enable_ddr_clock(void)
 {
 	int ret;
 	unsigned long rate;
-	unsigned long ddr_pll_freq, ddr_freq;
-
-	if (is_s32gen1_soc_rev1()) {
-		ddr_pll_freq = S32GEN1_DDR_PLL_VCO_FREQ;
-		ddr_freq = S32GEN1_DDR_FREQ;
-	} else {
-		ddr_pll_freq = S32G274A_REV2_DDR_PLL_VCO_FREQ;
-		ddr_freq = S32G274A_REV2_DDR_FREQ;
-	}
 
 	ret = s32gen1_set_parent(&ddr_pll_mux, &fxosc);
 	if (ret)
@@ -219,12 +210,12 @@ int s32g_enable_ddr_clock(void)
 	if (ret)
 		return ret;
 
-	rate = s32gen1_set_rate(&ddr_pll_vco, ddr_pll_freq);
-	if (rate != ddr_pll_freq)
+	rate = s32gen1_set_rate(&ddr_pll_vco, S32GEN1_DDR_PLL_VCO_FREQ);
+	if (rate != S32GEN1_DDR_PLL_VCO_FREQ)
 		return -EINVAL;
 
-	rate = s32gen1_set_rate(&ddr, ddr_freq);
-	if (rate != ddr_freq)
+	rate = s32gen1_set_rate(&ddr, S32GEN1_DDR_FREQ);
+	if (rate != S32GEN1_DDR_FREQ)
 		return -EINVAL;
 
 	return s32gen1_enable(&ddr, 1);
diff --git a/include/dt-bindings/clock/s32gen1-clock-freq.h b/include/dt-bindings/clock/s32gen1-clock-freq.h
index 96f4d3afc..2b8ab9d7a 100644
--- a/include/dt-bindings/clock/s32gen1-clock-freq.h
+++ b/include/dt-bindings/clock/s32gen1-clock-freq.h
@@ -13,6 +13,8 @@
 #define S32GEN1_XBAR_2X_FREQ			(800 * MHZ)
 #define S32GEN1_LIN_BAUD_CLK_FREQ		(125 * MHZ)
 #define S32GEN1_SDHC_CLK_FREQ			(400 * MHZ)
+#define S32GEN1_DDR_PLL_VCO_FREQ		(1600 * MHZ)
+#define S32GEN1_DDR_FREQ			(800 * MHZ)
 
 #define S32GEN1_A53_MAX_FREQ			(1000 * MHZ)
 #define S32GEN1_ARM_PLL_VCO_MAX_FREQ		(2000 * MHZ)
@@ -21,10 +23,6 @@
 #define S32GEN1_PERIPH_PLL_PHI2_MIN_FREQ	(40 * MHZ)
 #define S32GEN1_PERIPH_DFS3_FREQ		(800 * MHZ)
 #define S32GEN1_QSPI_MAX_FREQ			(200 * MHZ)
-#define S32GEN1_DDR_PLL_VCO_FREQ		(1333333333UL)
-#define S32GEN1_DDR_FREQ			(666666666UL)
-#define S32G274A_REV2_DDR_PLL_VCO_FREQ		(1600 * MHZ)
-#define S32G274A_REV2_DDR_FREQ			(800 * MHZ)
 #define S32G274A_REV2_QSPI_FREQ			(200 * MHZ)
 #define S32G274A_QSPI_FREQ			(133333333)
 
-- 
2.17.1

