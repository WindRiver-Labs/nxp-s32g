From f20b70b987febebf6a2ac52af5e08205f0f8c3bb Mon Sep 17 00:00:00 2001
From: Dan Nica <dan.nica@nxp.com>
Date: Fri, 3 Jul 2020 12:46:52 +0300
Subject: [PATCH 148/269] s32g: Init SRAM for BL33

This avoid sporadic crashes within BL33.

Issue: ALB-4935
Upstream-Status: Pending 

Signed-off-by: Dan Nica <dan.nica@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 plat/nxp/s32g/s32g_bl2_el3.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/plat/nxp/s32g/s32g_bl2_el3.c b/plat/nxp/s32g/s32g_bl2_el3.c
index e69435252..5ab3a7250 100644
--- a/plat/nxp/s32g/s32g_bl2_el3.c
+++ b/plat/nxp/s32g/s32g_bl2_el3.c
@@ -158,6 +158,8 @@ void bl2_el3_plat_arch_setup(void)
 	console_s32g_register(S32G_UART_BASE, S32G_UART_CLOCK_HZ,
 			      S32G_UART_BAUDRATE, &console);
 
+	sram_clr(S32G_BL33_IMAGE_BASE, BL2_BASE - S32G_BL33_IMAGE_BASE);
+
 	sram_clr(S32G_SSRAM_BASE, S32G_SSRAM_LIMIT - S32G_SSRAM_BASE);
 	copy_bl31ssram_image();
 	/* This will also populate CSR section from bl31ssram */
-- 
2.17.1

