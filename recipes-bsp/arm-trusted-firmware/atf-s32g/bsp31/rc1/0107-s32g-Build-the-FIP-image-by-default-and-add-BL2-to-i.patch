From 4bd429e2d29cc94cc630a5335569ae6b0c1d7f37 Mon Sep 17 00:00:00 2001
From: Dan Nica <dan.nica@nxp.com>
Date: Thu, 14 May 2020 14:02:54 +0300
Subject: [PATCH 107/269] s32g: Build the FIP image by default and add BL2 to
 it

Issue: ALB-4934
Upstream-Status: Pending 

Signed-off-by: Dan Nica <dan.nica@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 plat/s32g/platform.mk | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/plat/s32g/platform.mk b/plat/s32g/platform.mk
index d330cb45f..4c1d7ef72 100644
--- a/plat/s32g/platform.mk
+++ b/plat/s32g/platform.mk
@@ -80,6 +80,15 @@ check_dtc_version:
 		false; \
 	fi
 
+FIP_ALIGN := 512
+all: add_bl2_to_fip
+add_bl2_to_fip: fip
+	${Q}${FIPTOOL} update ${FIP_ARGS} \
+		--tb-fw ${BUILD_PLAT}/bl2.bin \
+		${BUILD_PLAT}/${FIP_NAME}
+	@echo "Added BL2 to ${BUILD_PLAT}/${FIP_NAME} successfully"
+	${Q}${FIPTOOL} info ${BUILD_PLAT}/${FIP_NAME}
+
 # Disable the PSCI platform compatibility layer
 ENABLE_PLAT_COMPAT	:= 0
 
-- 
2.17.1

