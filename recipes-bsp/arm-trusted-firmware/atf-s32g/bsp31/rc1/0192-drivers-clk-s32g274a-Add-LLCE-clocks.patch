From b8be267e390e7d5c27ae8bdff7f06fa7d172ad36 Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <Ghennadi.Procopciuc@nxp.com>
Date: Thu, 26 Nov 2020 10:11:56 +0200
Subject: [PATCH 192/269] drivers: clk: s32g274a: Add LLCE clocks

Issue: ALB-5829
Upstream-Status: Pending 

Signed-off-by: Ghennadi Procopciuc <Ghennadi.Procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/nxp/s32g/clk/s32g274a_clk.c      | 5 ++++-
 drivers/nxp/s32g/clk/s32g274a_scmi_ids.c | 5 +++++
 2 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/drivers/nxp/s32g/clk/s32g274a_clk.c b/drivers/nxp/s32g/clk/s32g274a_clk.c
index 63cd904f7..816a03079 100644
--- a/drivers/nxp/s32g/clk/s32g274a_clk.c
+++ b/drivers/nxp/s32g/clk/s32g274a_clk.c
@@ -10,8 +10,11 @@
 #define ARR_CLK(N)	S32G274A_CLK_INDEX(N)
 
 /* XBAR_2X */
+static struct s32gen1_part_block llce_block =
+		S32GEN1_PART_BLOCK_NO_STATUS(cgm0_mux0_clk, 3,
+					     s32gen1_part_block0);
 struct s32gen1_clk xbar_2x_clk =
-		S32GEN1_CHILD_CLK(cgm0_mux0_clk, 48 * MHZ, 800 * MHZ);
+		S32GEN1_FREQ_MODULE_CLK(llce_block, 48 * MHZ, 800 * MHZ);
 
 /* PER_CLK */
 static struct s32gen1_clk per_clk =
diff --git a/drivers/nxp/s32g/clk/s32g274a_scmi_ids.c b/drivers/nxp/s32g/clk/s32g274a_scmi_ids.c
index 83148faa7..cbc2d8cd7 100644
--- a/drivers/nxp/s32g/clk/s32g274a_scmi_ids.c
+++ b/drivers/nxp/s32g/clk/s32g274a_scmi_ids.c
@@ -76,6 +76,11 @@ struct s32gen1_scmi_clk s32g274a_scmi_clk[] = {
 			 S32GEN1_SCMI_COMPLEX_CLK, "pfe0_rx_mii"),
 	SCMI_ARRAY_ENTRY(S32G274A_SCMI_CLK_PFE2_TX_MII,
 			 S32GEN1_SCMI_COMPLEX_CLK, "pfe0_tx_mii"),
+	/* LLCE */
+	SCMI_ARRAY_ENTRY(S32G274A_SCMI_CLK_LLCE_SYS,
+			 S32GEN1_CLK_XBAR_DIV2, "llce_sys"),
+	SCMI_ARRAY_ENTRY(S32G274A_SCMI_CLK_LLCE_CAN_PE,
+			 S32GEN1_CLK_CAN_PE, "llce_can_pe"),
 };
 
 static int s32g_compound2clkid(uint32_t scmi_clk_id, uint32_t *clk_id)
-- 
2.17.1

