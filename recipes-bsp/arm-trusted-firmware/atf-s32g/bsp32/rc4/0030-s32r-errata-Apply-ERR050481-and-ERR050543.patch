From 26cf6e283882baea3446357866d8f6bb0cb17a41 Mon Sep 17 00:00:00 2001
From: Andra-Teodora Ilie <andra.ilie@nxp.com>
Date: Thu, 25 Nov 2021 15:19:43 +0200
Subject: [PATCH 30/50] s32r: errata: Apply ERR050481 and ERR050543

Issue: ALB-7411
Upstream-Status: Pending 

Signed-off-by: Andra-Teodora Ilie <andra.ilie@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 docs/design/cpu-specific-build-macros.rst | 6 +++---
 plat/nxp/s32/s32r/platform.mk             | 5 +++++
 2 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/docs/design/cpu-specific-build-macros.rst b/docs/design/cpu-specific-build-macros.rst
index edb08b3ab..c656e8ac6 100644
--- a/docs/design/cpu-specific-build-macros.rst
+++ b/docs/design/cpu-specific-build-macros.rst
@@ -317,11 +317,11 @@ For Neoverse N1, the following errata build flags are defined :
    CPU. This needs to be enabled for revisions r3p0, r3p1, r4p0, and r4p1, for
    revisions r0p0, r1p0, and r2p0 there is no workaround.
 
-For S32G2, the following errata build flags are defined :
+For S32G2 and S32R45, the following errata build flags are defined :
 -  ``ERRATA_S32_050481``: This applies errata ERR050481 workaround to S32G2
-   CPU family.
+   and S32R45 CPU family.
 -  ``ERRATA_S32_050543``: This applies errata ERR050543 workaround to S32G2
-   CPU family.
+   and S32R45 CPU family.
 
 DSU Errata Workarounds
 ----------------------
diff --git a/plat/nxp/s32/s32r/platform.mk b/plat/nxp/s32/s32r/platform.mk
index f7206e6aa..1ee1ddadd 100644
--- a/plat/nxp/s32/s32r/platform.mk
+++ b/plat/nxp/s32/s32r/platform.mk
@@ -19,6 +19,8 @@ PLAT_BL_COMMON_SOURCES += drivers/nxp/s32/clk/s32r45_clk.c \
 		plat/nxp/s32/s32gen1_mc_me.c \
 		plat/nxp/s32/s32gen1_mc_rgm.c \
 		plat/nxp/s32/s32gen1_sramc.c \
+		lib/cpus/aarch64/s32.S \
+		lib/cpus/aarch64/cortex_a53.S \
 
 BL2_SOURCES 	+=  \
 	plat/nxp/s32/s32r/s32r_bl2_el3.c \
@@ -27,6 +29,9 @@ BL31_SOURCES += \
 	       plat/nxp/s32/s32r/s32r_bl31.c \
 		   plat/nxp/s32/s32r/s32r_psci.c \
 
+ERRATA_S32_050481	:= 1
+ERRATA_S32_050543	:= 1
+
 # Which LinFlexD to use as a UART device
 S32_LINFLEX_MODULE := 0
 $(eval $(call add_define_val,S32_LINFLEX_MODULE,$(S32_LINFLEX_MODULE)))
-- 
2.17.1

