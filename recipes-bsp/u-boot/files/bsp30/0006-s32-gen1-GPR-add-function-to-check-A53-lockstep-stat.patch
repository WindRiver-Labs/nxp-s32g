From 08a8ea57e6939c31c341ff26354f4bdacb5fb69b Mon Sep 17 00:00:00 2001
From: Catalin Udma <catalin-dan.udma@nxp.com>
Date: Fri, 11 Jun 2021 10:04:06 +0300
Subject: [PATCH 06/14] s32-gen1 GPR: add function to check A53 lockstep status

Upstream-Status: Pending

Issue: ALB-6703

Signed-off-by: Catalin Udma <catalin-dan.udma@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 arch/arm/include/asm/arch-s32/s32-gen1/a53_cluster_gpr.h | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/arch/arm/include/asm/arch-s32/s32-gen1/a53_cluster_gpr.h b/arch/arm/include/asm/arch-s32/s32-gen1/a53_cluster_gpr.h
index f3d9ec52dd..c0b4a7fd8f 100644
--- a/arch/arm/include/asm/arch-s32/s32-gen1/a53_cluster_gpr.h
+++ b/arch/arm/include/asm/arch-s32/s32-gen1/a53_cluster_gpr.h
@@ -1,6 +1,6 @@
 // SPDX-License-Identifier: BSD-3-Clause
 /*
- * Copyright 2019 NXP
+ * Copyright 2019, 2021 NXP
  */
 
 #define A53_CLUSTER_GPR			0x4007C400ul
@@ -144,3 +144,8 @@
 
 #define GPR21_CA53_1_L2MERRSR_LOW_BITS_MASK		(0xffffffff)
 #define GPR21_CA53_1_L2MERRSR_LOW_BITS_VALUE(x)		(((x) & 0xffffffff) << 0)
+
+static inline bool is_a53_lockstep_enabled(void)
+{
+	return readl(A53_CLUSTER_GPR_GPR(6)) & GPR06_CA53_LOCKSTEP_EN_MASK;
+}
-- 
2.17.1

