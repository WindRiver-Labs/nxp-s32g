From 5b403e76a81fc8046a5ed4f5f4a62504da7f5eef Mon Sep 17 00:00:00 2001
From: "Radu Pirea (NXP OSS)" <radu-nicolae.pirea@oss.nxp.com>
Date: Wed, 9 Jun 2021 16:39:56 +0300
Subject: [PATCH 07/16] s32gen1_qspi: fix setting the dummy cycles

Issue: ALB-7012

Upstream-Status: Pending

Signed-off-by: Radu Pirea (NXP OSS) <radu-nicolae.pirea@oss.nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/spi/s32gen1_qspi.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/spi/s32gen1_qspi.c b/drivers/spi/s32gen1_qspi.c
index fd8a148cd8..2beb08840b 100644
--- a/drivers/spi/s32gen1_qspi.c
+++ b/drivers/spi/s32gen1_qspi.c
@@ -435,7 +435,7 @@ static bool add_op_to_lutdb(struct fsl_qspi_priv *priv,
 		return false;
 
 	if (op->dummy.nbytes) {
-		lut = OPRND0(op->dummy.nbytes) |
+		lut = OPRND0(op->dummy.nbytes * 8 / op->dummy.buswidth) |
 		    INSTR0(LUT_DUMMY) |
 		    PAD0(busw_to_pads(op->dummy.buswidth, &status));
 		if (status)
-- 
2.17.1

