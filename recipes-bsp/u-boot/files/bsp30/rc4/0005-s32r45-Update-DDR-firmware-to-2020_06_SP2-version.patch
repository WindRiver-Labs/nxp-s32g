From 44ac850092481ac34ffdb96214ea5c813fec37c2 Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Date: Mon, 26 Jul 2021 15:36:30 +0300
Subject: [PATCH 05/16] s32r45: Update DDR firmware to 2020_06_SP2 version

Upstream-Status: Pending

Issue: ALB-7328
Signed-off-by: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 board/freescale/s32-gen1/s32r45/ddrc_cfg.c    | 260 +++++++++---------
 board/freescale/s32-gen1/s32r45/dmem_cfg.c    |  30 +-
 board/freescale/s32-gen1/s32r45/dq_swap_cfg.c |   2 +-
 board/freescale/s32-gen1/s32r45/phy_cfg.c     |   8 +-
 board/freescale/s32-gen1/s32r45/pie_cfg.c     |   4 +-
 5 files changed, 152 insertions(+), 152 deletions(-)

diff --git a/board/freescale/s32-gen1/s32r45/ddrc_cfg.c b/board/freescale/s32-gen1/s32r45/ddrc_cfg.c
index c1ba1f917e..9be320e1b8 100644
--- a/board/freescale/s32-gen1/s32r45/ddrc_cfg.c
+++ b/board/freescale/s32-gen1/s32r45/ddrc_cfg.c
@@ -32,150 +32,150 @@
 #include "ddr_init.h"
 
 struct regconf ddrc_cfg[] = {
-	{0x4007c604, 0x00000000},
+	{0x4007c604, 0x00000000U},
 #ifdef CONFIG_S32GEN1_DRAM_INLINE_ECC
-	{0x4007c608, 0x37ffffff},
+	{0x4007c608, 0x37ffffffU},
 #else
-	{0x4007c608, 0x00000000},
+	{0x4007c608, 0x00000000U},
 #endif
-	{0x403c0000, 0x83080020},
-	{0x403c0010, 0x00000030},
-	{0x403c0014, 0x00000000},
-	{0x403c001c, 0x00000000},
-	{0x403c0020, 0x00000202},
-	{0x403c0024, 0x0186a000},
-	{0x403c002c, 0x00000001},
-	{0x403c0030, 0x00000020},
-	{0x403c0034, 0x00402010},
-	{0x403c0038, 0x00000000},
-	{0x403c0050, 0x00210070},
-	{0x403c0054, 0x00000000},
-	{0x403c0060, 0x00000000},
-	{0x403c0064, 0x006100e0},
-	{0x403c0068, 0x008c0000},
+	{0x403c0000, 0x83080020U},
+	{0x403c0010, 0x00000030U},
+	{0x403c0014, 0x00000000U},
+	{0x403c001c, 0x00000000U},
+	{0x403c0020, 0x00000202U},
+	{0x403c0024, 0x0186a000U},
+	{0x403c002c, 0x00000001U},
+	{0x403c0030, 0x00000020U},
+	{0x403c0034, 0x00402010U},
+	{0x403c0038, 0x00000000U},
+	{0x403c0050, 0x00210040U},
+	{0x403c0054, 0x00000000U},
+	{0x403c0060, 0x00000000U},
+	{0x403c0064, 0x006100e0U},
+	{0x403c0068, 0x008c0000U},
 #ifdef CONFIG_S32GEN1_DRAM_INLINE_ECC
-	{0x403c0070, 0x033f7f54},
-	{0x403c0074, 0x00000780},
+	{0x403c0070, 0x033f7f54U},
+	{0x403c0074, 0x00000780U},
 #else
-	{0x403c0070, 0x033f7f40},
-	{0x403c0074, 0x000007b0},
+	{0x403c0070, 0x033f7f40U},
+	{0x403c0074, 0x000007b0U},
 #endif
-	{0x403c007c, 0x00000700},
-	{0x403c00b8, 0x00000000},
-	{0x403c00bc, 0x00000000},
-	{0x403c00c0, 0x00000000},
-	{0x403c00c4, 0x00001000},
-	{0x403c00d0, 0xc003061c},
-	{0x403c00d4, 0x009e0000},
-	{0x403c00d8, 0x00000d05},
-	{0x403c00dc, 0x0054002d},
-	{0x403c00e0, 0x00330008},
-	{0x403c00e4, 0x00100004},
-	{0x403c00e8, 0x0066004d},
-	{0x403c00ec, 0x0006004f},
-	{0x403c00f0, 0x00000000},
-	{0x403c00f4, 0x00000779},
-	{0x403c0100, 0x1a201b22},
-	{0x403c0104, 0x00060633},
-	{0x403c0108, 0x070e1517},
-	{0x403c010c, 0x00c0c000},
-	{0x403c0110, 0x0f04080f},
-	{0x403c0114, 0x02040c0c},
-	{0x403c0118, 0x01010007},
-	{0x403c011c, 0x00000401},
-	{0x403c0120, 0x03034405},
-	{0x403c0124, 0x0004040d},
-	{0x403c0128, 0x001c180a},
-	{0x403c012c, 0x440c021c},
-	{0x403c0130, 0x00020000},
-	{0x403c0134, 0x0c100002},
-	{0x403c0138, 0x000000e6},
-	{0x403c013c, 0x00000000},
-	{0x403c0180, 0xc3200018},
-	{0x403c0184, 0x028061a8},
-	{0x403c0188, 0x00000000},
-	{0x403c0190, 0x0497820a},
-	{0x403c0194, 0x00080303},
-	{0x403c0198, 0x07000000},
-	{0x403c019c, 0x00000000},
-	{0x403c01a0, 0xe0400018},
-	{0x403c01a4, 0x00df00e4},
-	{0x403c01a8, 0x80000000},
-	{0x403c01b0, 0x00000051},
-	{0x403c01b4, 0x0000170a},
-	{0x403c01b8, 0x00000000},
-	{0x403c01c0, 0x00000001},
-	{0x403c01c4, 0x00000001},
+	{0x403c007c, 0x00000700U},
+	{0x403c00b8, 0x00000000U},
+	{0x403c00bc, 0x00000000U},
+	{0x403c00c0, 0x00000000U},
+	{0x403c00c4, 0x00001000U},
+	{0x403c00d0, 0xc003061cU},
+	{0x403c00d4, 0x009e0000U},
+	{0x403c00d8, 0x00000d05U},
+	{0x403c00dc, 0x0054002dU},
+	{0x403c00e0, 0x00330008U},
+	{0x403c00e4, 0x00100004U},
+	{0x403c00e8, 0x0066004dU},
+	{0x403c00ec, 0x0004004fU},
+	{0x403c00f0, 0x00000000U},
+	{0x403c00f4, 0x00000779U},
+	{0x403c0100, 0x1a201b22U},
+	{0x403c0104, 0x00060633U},
+	{0x403c0108, 0x070e1517U},
+	{0x403c010c, 0x00c0c000U},
+	{0x403c0110, 0x0f04080fU},
+	{0x403c0114, 0x02040c0cU},
+	{0x403c0118, 0x01010007U},
+	{0x403c011c, 0x00000401U},
+	{0x403c0120, 0x03034405U},
+	{0x403c0124, 0x0004040dU},
+	{0x403c0128, 0x001c180aU},
+	{0x403c012c, 0x440c021cU},
+	{0x403c0130, 0x00020000U},
+	{0x403c0134, 0x0c100002U},
+	{0x403c0138, 0x000000e6U},
+	{0x403c013c, 0x00000000U},
+	{0x403c0180, 0x03200018U},
+	{0x403c0184, 0x028061a8U},
+	{0x403c0188, 0x00000000U},
+	{0x403c0190, 0x0497820aU},
+	{0x403c0194, 0x00080303U},
+	{0x403c0198, 0x07000000U},
+	{0x403c019c, 0x00000000U},
+	{0x403c01a0, 0xe0400018U},
+	{0x403c01a4, 0x00df00e4U},
+	{0x403c01a8, 0x80000000U},
+	{0x403c01b0, 0x00000051U},
+	{0x403c01b4, 0x0000170aU},
+	{0x403c01b8, 0x00000000U},
+	{0x403c01c0, 0x00000001U},
+	{0x403c01c4, 0x00000001U},
 #ifdef CONFIG_S32GEN1_DRAM_INLINE_ECC
-	{0x403c0200, 0x00000014},
-	{0x403c0204, 0x00050505},
+	{0x403c0200, 0x00000014U},
+	{0x403c0204, 0x00050505U},
 #else
-	{0x403c0200, 0x00000017},
-	{0x403c0204, 0x00080808},
+	{0x403c0200, 0x00000017U},
+	{0x403c0204, 0x00080808U},
 #endif
-	{0x403c0208, 0x00000000},
+	{0x403c0208, 0x00000000U},
 #ifdef CONFIG_S32GEN1_DRAM_INLINE_ECC
-	{0x403c020c, 0x14141400},
+	{0x403c020c, 0x14141400U},
 #else
-	{0x403c020c, 0x00000000},
+	{0x403c020c, 0x00000000U},
 #endif
-	{0x403c0210, 0x00001f1f},
+	{0x403c0210, 0x00001f1fU},
 #ifdef CONFIG_S32GEN1_DRAM_INLINE_ECC
-	{0x403c0214, 0x04040404},
-	{0x403c0218, 0x04040404},
+	{0x403c0214, 0x04040404U},
+	{0x403c0218, 0x04040404U},
 #else
-	{0x403c0214, 0x07070707},
-	{0x403c0218, 0x07070707},
+	{0x403c0214, 0x07070707U},
+	{0x403c0218, 0x07070707U},
 #endif
-	{0x403c021c, 0x0000000f},
-	{0x403c0220, 0x00003f3f},
-	{0x403c0224, 0x00000000},
-	{0x403c0228, 0x00000000},
-	{0x403c022c, 0x00000000},
-	{0x403c0240, 0x04000400},
-	{0x403c0244, 0x00000000},
-	{0x403c0250, 0x29001505},
-	{0x403c0254, 0x0000002c},
-	{0x403c025c, 0x5900575b},
-	{0x403c0264, 0x90000096},
-	{0x403c026c, 0x1000012c},
-	{0x403c0300, 0x00000000},
-	{0x403c0304, 0x00000000},
-	{0x403c030c, 0x00000000},
-	{0x403c0320, 0x00000001},
-	{0x403c0330, 0x00b03033},
-	{0x403c0334, 0x00000000},
-	{0x403c036c, 0x00000011},
-	{0x403c0374, 0x00000000},
-	{0x403c037c, 0x00000000},
-	{0x403c0384, 0x00000000},
-	{0x403c03c0, 0x00000003},
-	{0x403c03e0, 0x00010001},
-	{0x403c03e8, 0x00010001},
-	{0x403c0400, 0x00000111},
-	{0x403c0404, 0x000010f3},
-	{0x403c0408, 0x000072ff},
-	{0x403c0490, 0x00000000},
-	{0x403c0494, 0x00000e00},
-	{0x403c0498, 0x006207ff},
-	{0x403c049c, 0x01010e07},
-	{0x403c04a0, 0x034b07ff},
-	{0x403c04b4, 0x00000000},
-	{0x403c04b8, 0x00004000},
-	{0x403c0540, 0x00000000},
-	{0x403c0544, 0x02000e00},
-	{0x403c0548, 0x00000000},
-	{0x403c054c, 0x00000e00},
-	{0x403c0550, 0x00000000},
-	{0x403c0564, 0x00000000},
-	{0x403c0568, 0x00004000},
-	{0x403c05f0, 0x00000000},
-	{0x403c05f4, 0x02000e00},
-	{0x403c05f8, 0x00000000},
-	{0x403c05fc, 0x00000e00},
-	{0x403c0600, 0x00000000},
-	{0x403c0f24, 0x0000ff10},
-	{0x403c0f2c, 0x00000000},
+	{0x403c021c, 0x00000f0fU},
+	{0x403c0220, 0x00003f3fU},
+	{0x403c0224, 0x00000000U},
+	{0x403c0228, 0x00000000U},
+	{0x403c022c, 0x00000000U},
+	{0x403c0240, 0x04000400U},
+	{0x403c0244, 0x00000000U},
+	{0x403c0250, 0x29001f05U},
+	{0x403c0254, 0x00000000U},
+	{0x403c025c, 0x10002200U},
+	{0x403c0264, 0x1f002100U},
+	{0x403c026c, 0x1f002100U},
+	{0x403c0300, 0x00000000U},
+	{0x403c0304, 0x00000000U},
+	{0x403c030c, 0x00000000U},
+	{0x403c0320, 0x00000001U},
+	{0x403c0330, 0x00b03033U},
+	{0x403c0334, 0x00000000U},
+	{0x403c036c, 0x00000011U},
+	{0x403c0374, 0x00000000U},
+	{0x403c037c, 0x00000000U},
+	{0x403c0384, 0x00000000U},
+	{0x403c03c0, 0x00000003U},
+	{0x403c03e0, 0x00010001U},
+	{0x403c03e8, 0x00010001U},
+	{0x403c0400, 0x00000011U},
+	{0x403c0404, 0x00005193U},
+	{0x403c0408, 0x00001196U},
+	{0x403c0490, 0x00000000U},
+	{0x403c0494, 0x02000e00U},
+	{0x403c0498, 0x003c0200U},
+	{0x403c049c, 0x00000e00U},
+	{0x403c04a0, 0x003c0200U},
+	{0x403c04b4, 0x00015193U},
+	{0x403c04b8, 0x00001196U},
+	{0x403c0540, 0x00000000U},
+	{0x403c0544, 0x02000e00U},
+	{0x403c0548, 0x003c0200U},
+	{0x403c054c, 0x00000e00U},
+	{0x403c0550, 0x003c0200U},
+	{0x403c0564, 0x00015193U},
+	{0x403c0568, 0x00001196U},
+	{0x403c05f0, 0x00000000U},
+	{0x403c05f4, 0x02000e00U},
+	{0x403c05f8, 0x003c0200U},
+	{0x403c05fc, 0x00000e00U},
+	{0x403c0600, 0x003c0200U},
+	{0x403c0f24, 0x0000ff10U},
+	{0x403c0f2c, 0x00000000U},
 };
 
-size_t ddrc_cfg_size = sizeof(ddrc_cfg) / sizeof(struct regconf);
+size_t ddrc_cfg_size = ARRAY_SIZE(ddrc_cfg);
diff --git a/board/freescale/s32-gen1/s32r45/dmem_cfg.c b/board/freescale/s32-gen1/s32r45/dmem_cfg.c
index 5b3cdeeea8..cf664a2301 100644
--- a/board/freescale/s32-gen1/s32r45/dmem_cfg.c
+++ b/board/freescale/s32-gen1/s32r45/dmem_cfg.c
@@ -62,13 +62,13 @@ u16 dmem_1d[] = {
 	0x4d66,
 	0x4f08,
 	0x0000,
-	0x0006,
+	0x0004,
 	0x2d54,
 	0x0033,
 	0x4d66,
 	0x4f08,
 	0x0000,
-	0x0006,
+	0x0004,
 	0x0000,
 	0x0000,
 	0x0000,
@@ -87,13 +87,13 @@ u16 dmem_1d[] = {
 	0x6600,
 	0x084d,
 	0x004f,
-	0x0600,
+	0x0400,
 	0x5400,
 	0x332d,
 	0x6600,
 	0x084d,
 	0x004f,
-	0x0600,
+	0x0400,
 	0x0000,
 	0x0000,
 	0x0000,
@@ -576,8 +576,8 @@ u16 dmem_1d[] = {
 	0x6590,
 	0x0000,
 	0x0000,
-	0x9f38,
-	0x0058,
+	0x3a44,
+	0x0075,
 	0x0000,
 	0x0000,
 	0x2820,
@@ -864,7 +864,7 @@ u16 dmem_1d[] = {
 	0x0000,
 };
 
-size_t dmem_1d_size = sizeof(dmem_1d) / sizeof(u16);
+size_t dmem_1d_size = ARRAY_SIZE(dmem_1d);
 
 u16 dmem_2d[] = {
 	0x0000,
@@ -883,7 +883,7 @@ u16 dmem_2d[] = {
 	0x0100,
 	0x0000,
 	0x0100,
-	0x1f7f,
+	0x2080,
 	0x0000,
 	0x0310,
 	0x0000,
@@ -897,13 +897,13 @@ u16 dmem_2d[] = {
 	0x4d66,
 	0x4f08,
 	0x0000,
-	0x0006,
+	0x0004,
 	0x2d54,
 	0x0033,
 	0x4d66,
 	0x4f08,
 	0x0000,
-	0x0006,
+	0x0004,
 	0x0000,
 	0x0000,
 	0x0000,
@@ -922,13 +922,13 @@ u16 dmem_2d[] = {
 	0x6600,
 	0x084d,
 	0x004f,
-	0x0600,
+	0x0400,
 	0x5400,
 	0x332d,
 	0x6600,
 	0x084d,
 	0x004f,
-	0x0600,
+	0x0400,
 	0x0000,
 	0x0000,
 	0x0000,
@@ -1431,8 +1431,8 @@ u16 dmem_2d[] = {
 	0x0000,
 	0x0000,
 	0x0000,
-	0x9f38,
-	0x0058,
+	0x3a44,
+	0x0075,
 	0x0000,
 	0x321e,
 	0x0100,
@@ -1571,4 +1571,4 @@ u16 dmem_2d[] = {
 	0x0000,
 };
 
-size_t dmem_2d_size = sizeof(dmem_2d) / sizeof(u16);
+size_t dmem_2d_size = ARRAY_SIZE(dmem_2d);
diff --git a/board/freescale/s32-gen1/s32r45/dq_swap_cfg.c b/board/freescale/s32-gen1/s32r45/dq_swap_cfg.c
index 8cd3c9c4a2..9ac283656c 100644
--- a/board/freescale/s32-gen1/s32r45/dq_swap_cfg.c
+++ b/board/freescale/s32-gen1/s32r45/dq_swap_cfg.c
@@ -66,4 +66,4 @@ struct dqconf dq_swap_cfg[] = {
 	{0x4039a84c, 0x03},
 };
 
-size_t dq_swap_cfg_size = sizeof(dq_swap_cfg) / sizeof(struct dqconf);
+size_t dq_swap_cfg_size = ARRAY_SIZE(dq_swap_cfg);
diff --git a/board/freescale/s32-gen1/s32r45/phy_cfg.c b/board/freescale/s32-gen1/s32r45/phy_cfg.c
index 0d40a5a733..3e7e4f3fa8 100644
--- a/board/freescale/s32-gen1/s32r45/phy_cfg.c
+++ b/board/freescale/s32-gen1/s32r45/phy_cfg.c
@@ -31,7 +31,7 @@
 
 #include "ddr_init.h"
 
-struct regconf phy_cfg[] = {
+struct regconf_16 phy_cfg[] = {
 	{0x4038040c, 0x00000001},
 	{0x40380bdc, 0x00000001},
 	{0x403945dc, 0x000001ff},
@@ -55,11 +55,11 @@ struct regconf phy_cfg[] = {
 	{0x403816dc, 0x00000019},
 	{0x40381494, 0x00000002},
 	{0x40380c58, 0x00000000},
-	{0x40381438, 0x000000e3},
+	{0x40381438, 0x000001e3},
 	{0x403814fc, 0x00000002},
 	{0x40381618, 0x00000212},
 	{0x40381608, 0x00000061},
-	{0x40381530, 0x00000007},
+	{0x40381530, 0x00000003},
 	{0x403945a0, 0x00000600},
 	{0x403945a4, 0x00000600},
 	{0x403965a0, 0x00000600},
@@ -120,4 +120,4 @@ struct regconf phy_cfg[] = {
 	{0x40381478, 0x00000000},
 };
 
-size_t phy_cfg_size = sizeof(phy_cfg) / sizeof(struct regconf);
+size_t phy_cfg_size = ARRAY_SIZE(phy_cfg);
diff --git a/board/freescale/s32-gen1/s32r45/pie_cfg.c b/board/freescale/s32-gen1/s32r45/pie_cfg.c
index 5f6277bf7c..249437a2fc 100644
--- a/board/freescale/s32-gen1/s32r45/pie_cfg.c
+++ b/board/freescale/s32-gen1/s32r45/pie_cfg.c
@@ -31,7 +31,7 @@
 
 #include "ddr_init.h"
 
-struct regconf pie_cfg[] = {
+struct regconf_16 pie_cfg[] = {
 	{0x40380c04, 0x00000010},
 	{0x40380c0c, 0x00000400},
 	{0x40380c24, 0x0000010e},
@@ -592,4 +592,4 @@ struct regconf pie_cfg[] = {
 	{0x40380bec, 0x00000002},
 };
 
-size_t pie_cfg_size = sizeof(pie_cfg) / sizeof(struct regconf);
+size_t pie_cfg_size = ARRAY_SIZE(pie_cfg);
-- 
2.17.1

