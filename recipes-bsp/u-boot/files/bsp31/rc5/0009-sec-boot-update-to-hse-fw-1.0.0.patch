From befae98e1f7adeca0b2328922be4f9972679a783 Mon Sep 17 00:00:00 2001
From: Vlad Pelin <vlad.pelin@nxp.com>
Date: Thu, 4 Nov 2021 12:26:41 +0200
Subject: [PATCH 09/19] sec-boot: update to hse fw 1.0.0

Issue: ALB-8069
Upstream-Status: Pending 

Signed-off-by: Vlad Pelin <vlad.pelin@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 arch/arm/cpu/armv8/s32/s32-gen1/hse_adv_secboot.c | 1 +
 include/hse/hse_abi.h                             | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/arch/arm/cpu/armv8/s32/s32-gen1/hse_adv_secboot.c b/arch/arm/cpu/armv8/s32/s32-gen1/hse_adv_secboot.c
index ff423f045c..818848376a 100644
--- a/arch/arm/cpu/armv8/s32/s32-gen1/hse_adv_secboot.c
+++ b/arch/arm/cpu/armv8/s32/s32-gen1/hse_adv_secboot.c
@@ -243,6 +243,7 @@ int hse_install_smr_entry(struct hse_private *priv, u32 *recv_buf)
 	smr_entry->sign_sch.sch.hash_algo = HSE_HASH_ALGO_SHA_1;
 	smr_entry->auth_tag = HSE_AUTH_TAG_SD;
 	smr_entry->decrypt_key_handle = HSE_SMR_DECRYPT_KEY_HANDLE_NOT_USED;
+	smr_entry->version_offset = 0;
 
 	priv->srv_desc.srv_id = HSE_SRV_ID_SMR_ENTRY_INSTALL;
 	smr_install_req->access_mode = HSE_ACCESS_MODE_ONE_PASS;
diff --git a/include/hse/hse_abi.h b/include/hse/hse_abi.h
index d29f8168d3..ac54fb453d 100644
--- a/include/hse/hse_abi.h
+++ b/include/hse/hse_abi.h
@@ -256,6 +256,7 @@ struct hse_sign_scheme {
  * @sign_sch: auth scheme used to verify the SMR
  * @auth_tag: location of SMR signature in flash
  * @decrypt_key_handle: specifies parameters for smr decryption
+ * @version_offset: unused, must be set to 0
  */
 struct hse_smr_entry {
 	u32 smr_src;
@@ -270,6 +271,7 @@ struct hse_smr_entry {
 	u8 reserved2[4];
 	u32 decrypt_key_handle;
 	u8 reserved3[12];
+	u32 version_offset;
 } __packed;
 
 /**
-- 
2.17.1

