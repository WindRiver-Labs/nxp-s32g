From 9cf3096692cda32a290f343b4abfeb253d88167e Mon Sep 17 00:00:00 2001
From: Dan Nica <dan.nica@nxp.com>
Date: Mon, 15 Nov 2021 16:09:06 +0200
Subject: [PATCH 09/20] s32gen1: Enable HS400 Enhanced Strobe

Issue: ALB-8194
Upstream-Status: Pending 

Signed-off-by: Dan Nica <dan.nica@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 board/freescale/Kconfig     | 1 +
 drivers/mmc/fsl_esdhc_imx.c | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/board/freescale/Kconfig b/board/freescale/Kconfig
index 920fbd831c..58b2189f8a 100644
--- a/board/freescale/Kconfig
+++ b/board/freescale/Kconfig
@@ -26,6 +26,7 @@ config S32_GEN1
 	select ARCH_MISC_INIT
 	select S32_GPIO
 	select MMC_HS400_SUPPORT if !TARGET_TYPE_S32GEN1_EMULATOR
+	select MMC_HS400_ES_SUPPORT if !TARGET_TYPE_S32GEN1_EMULATOR
 	select ARM_ERRATA_855873 if S32_STANDALONE_BOOT_FLOW
 	help
 	  Platform Selection
diff --git a/drivers/mmc/fsl_esdhc_imx.c b/drivers/mmc/fsl_esdhc_imx.c
index 0007daea73..90608186a8 100644
--- a/drivers/mmc/fsl_esdhc_imx.c
+++ b/drivers/mmc/fsl_esdhc_imx.c
@@ -1747,7 +1747,7 @@ static struct esdhc_soc_data usdhc_imx8qm_data = {
 static struct esdhc_soc_data usdhc_s32gen1_data = {
 	.flags = ESDHC_FLAG_USDHC | ESDHC_FLAG_STD_TUNING |
 		ESDHC_FLAG_HAVE_CAP1 | ESDHC_FLAG_HS200 |
-		ESDHC_FLAG_HS400,
+		ESDHC_FLAG_HS400 | ESDHC_FLAG_HS400_ES,
 };
 
 static const struct udevice_id fsl_esdhc_ids[] = {
-- 
2.17.1

