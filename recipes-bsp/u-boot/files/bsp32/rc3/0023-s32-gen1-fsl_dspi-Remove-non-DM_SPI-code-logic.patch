From 688311b4a4721d87ed1244084dd79438b3436e56 Mon Sep 17 00:00:00 2001
From: Ciprian Costea <ciprianmarian.costea@nxp.com>
Date: Fri, 14 Jan 2022 12:41:06 +0200
Subject: [PATCH 23/25] s32-gen1: fsl_dspi: Remove non DM_SPI code logic

Issue: ALB-8340
Upstream-Status: Pending 

Signed-off-by: Ciprian Costea <ciprianmarian.costea@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 arch/arm/cpu/armv8/s32/s32-gen1/soc.c         | 36 -------------------
 .../asm/arch-s32/s32-gen1/s32-gen1-regs.h     |  6 ----
 include/fsl_dspi.h                            |  7 +---
 3 files changed, 1 insertion(+), 48 deletions(-)

diff --git a/arch/arm/cpu/armv8/s32/s32-gen1/soc.c b/arch/arm/cpu/armv8/s32/s32-gen1/soc.c
index f64cfec8b0..e964b7bf0f 100644
--- a/arch/arm/cpu/armv8/s32/s32-gen1/soc.c
+++ b/arch/arm/cpu/armv8/s32/s32-gen1/soc.c
@@ -20,9 +20,6 @@
 #include <ddr_init.h>
 #endif
 #include <board_common.h>
-#ifdef CONFIG_FSL_DSPI
-#include <fsl_dspi.h>
-#endif
 #ifdef CONFIG_SAF1508BET_USB_PHY
 #include <dm/device.h>
 #include <dm/device-internal.h>
@@ -358,39 +355,6 @@ int arch_misc_init(void)
 	return 0;
 }
 
-#ifdef CONFIG_FSL_DSPI
-int mmap_dspi(unsigned short bus, struct dspi **base_addr)
-{
-	unsigned long addr;
-
-	switch (bus) {
-	case 0:
-		addr = SPI0_BASE_ADDR;
-		break;
-	case 1:
-		addr = SPI1_BASE_ADDR;
-		break;
-	case 2:
-		addr = SPI2_BASE_ADDR;
-		break;
-	case 3:
-		addr = SPI3_BASE_ADDR;
-		break;
-	case 4:
-		addr = SPI4_BASE_ADDR;
-		break;
-	case 5:
-		addr = SPI5_BASE_ADDR;
-		break;
-	default:
-		return -ENODEV;
-	}
-
-	*base_addr = (struct dspi *)addr;
-	return 0;
-}
-#endif
-
 __weak u32 get_sram_size(void)
 {
 	return S32_SRAM_SIZE;
diff --git a/arch/arm/include/asm/arch-s32/s32-gen1/s32-gen1-regs.h b/arch/arm/include/asm/arch-s32/s32-gen1/s32-gen1-regs.h
index 97b5241bc7..f6e5144652 100644
--- a/arch/arm/include/asm/arch-s32/s32-gen1/s32-gen1-regs.h
+++ b/arch/arm/include/asm/arch-s32/s32-gen1/s32-gen1-regs.h
@@ -119,9 +119,6 @@
 #endif
 #define LINFLEXD0_BASE_ADDR			(PER_GROUP1_BASE + 0x000C8000)
 #define LINFLEXD1_BASE_ADDR			(PER_GROUP1_BASE + 0x000CC000)
-#define SPI0_BASE_ADDR				(PER_GROUP1_BASE + 0x000D4000)
-#define SPI1_BASE_ADDR				(PER_GROUP1_BASE + 0x000D8000)
-#define SPI2_BASE_ADDR				(PER_GROUP1_BASE + 0x000DC000)
 #define I2C1_BASE_ADDR				(PER_GROUP1_BASE + 0x000E4000)
 #define I2C2_BASE_ADDR				(PER_GROUP1_BASE + 0x000E8000)
 #define I2C3_BASE_ADDR				(PER_GROUP1_BASE + 0x000EC000)
@@ -184,9 +181,6 @@
 #define CAN_FD3_BASE_ADDR			(PER_GROUP2_BASE + 0x000B0000)
 #endif
 #define LINFLEXD2_BASE_ADDR			(PER_GROUP2_BASE + 0x000BC000)
-#define SPI3_BASE_ADDR				(PER_GROUP2_BASE + 0x000C8000)
-#define SPI4_BASE_ADDR				(PER_GROUP2_BASE + 0x000CC000)
-#define SPI5_BASE_ADDR				(PER_GROUP2_BASE + 0x000D0000)
 #define I2C4_BASE_ADDR				(PER_GROUP2_BASE + 0x000D8000)
 #define I2C5_BASE_ADDR				(PER_GROUP2_BASE + 0x000DC000)
 #define FLEXTIMER1_BASE_ADDR			(PER_GROUP2_BASE + 0x000E4000)
diff --git a/include/fsl_dspi.h b/include/fsl_dspi.h
index 5765c23c28..65a9bf0c24 100644
--- a/include/fsl_dspi.h
+++ b/include/fsl_dspi.h
@@ -6,7 +6,7 @@
  * TsiChung Liew (Tsi-Chung.Liew@freescale.com)
  * Chao Fu (B44548@freesacle.com)
  * Haikun Wang (B53464@freescale.com)
- * Copyright 2017, 2019-2020 NXP
+ * Copyright 2017, 2019-2020, 2022 NXP
  */
 
 #ifndef _FSL_DSPI_H_
@@ -153,9 +153,4 @@ struct dspi {
 /* Bit definitions and macros for DRFDR group */
 #define DSPI_RFDR_RXDATA(x)		((x) & 0x0000FFFF)
 
-/* Return in base_addr the base address of any given DSPI instance */
-#ifdef CONFIG_ARCH_S32
-int mmap_dspi(unsigned short bus, struct dspi **base_addr);
-#endif
-
 #endif				/* _FSL_DSPI_H_ */
-- 
2.17.1

