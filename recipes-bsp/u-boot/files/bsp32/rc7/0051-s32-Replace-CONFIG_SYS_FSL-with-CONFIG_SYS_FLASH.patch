From 25a03dc9a0c77549d2b0c8510d141965cfa96ae4 Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Date: Fri, 18 Feb 2022 14:35:10 +0200
Subject: [PATCH 51/51] s32: Replace CONFIG_SYS_FSL* with CONFIG_SYS_FLASH*

Issue: ALB-8483
Upstream-Status: Pending 

Signed-off-by: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 arch/arm/cpu/armv8/s32/cpu.c |  6 +++---
 include/configs/s32-gen1.h   |  5 +++--
 include/configs/s32.h        | 11 +++++------
 scripts/config_whitelist.txt |  4 ----
 4 files changed, 11 insertions(+), 15 deletions(-)

diff --git a/arch/arm/cpu/armv8/s32/cpu.c b/arch/arm/cpu/armv8/s32/cpu.c
index 27b1f15dd0..64361fbee0 100644
--- a/arch/arm/cpu/armv8/s32/cpu.c
+++ b/arch/arm/cpu/armv8/s32/cpu.c
@@ -61,8 +61,8 @@ static struct mm_region s32_mem_map[] = {
 	  PTE_BLOCK_PXN | PTE_BLOCK_UXN
 	},
 	{
-	  CONFIG_SYS_FSL_FLASH0_BASE, CONFIG_SYS_FSL_FLASH0_BASE,
-	  CONFIG_SYS_FSL_FLASH0_SIZE,
+	  CONFIG_SYS_FLASH_BASE, CONFIG_SYS_FLASH_BASE,
+	  CONFIG_SYS_FLASH_SIZE,
 	  PTE_BLOCK_MEMTYPE(MT_NORMAL) | PTE_BLOCK_OUTER_SHARE
 	},
 #if defined(CONFIG_PCIE_S32GEN1)
@@ -101,7 +101,7 @@ static void disable_qspi_mmu_entry(void)
 	/* Skip AHB mapping by setting its size to 0 */
 	for (i = 0; i < ARRAY_SIZE(s32_mem_map); i++) {
 		region = &s32_mem_map[i];
-		if (region->phys == CONFIG_SYS_FSL_FLASH0_BASE) {
+		if (region->phys == CONFIG_SYS_FLASH_BASE) {
 			region->size = 0U;
 			break;
 		}
diff --git a/include/configs/s32-gen1.h b/include/configs/s32-gen1.h
index b5f34b3f16..cabdf09404 100644
--- a/include/configs/s32-gen1.h
+++ b/include/configs/s32-gen1.h
@@ -29,8 +29,9 @@
 #endif
 
 /* memory mapped external flash */
-#define CONFIG_SYS_FSL_FLASH0_BASE      0x0
-#define CONFIG_SYS_FSL_FLASH0_SIZE      0x20000000
+#define CONFIG_SYS_FLASH_BASE		0x0
+#define CONFIG_SYS_FLASH_SIZE		0x20000000
+
 #define QSPI_BASE_ADDR		        0x40134000
 
 #if defined(CONFIG_TARGET_S32G274ABLUEBOX3)
diff --git a/include/configs/s32.h b/include/configs/s32.h
index 8a6c82a822..cb1d38ce94 100644
--- a/include/configs/s32.h
+++ b/include/configs/s32.h
@@ -46,20 +46,19 @@
  * parantheses. Also these should be kept in sync with
  * 'conf/machine/include/s32*flashmap.inc'.
  */
-#define CONFIG_SYS_FLASH_BASE		CONFIG_SYS_FSL_FLASH0_BASE
 #define KERNEL_FLASH_MAXSIZE		0xe00000
 #define FDT_FLASH_MAXSIZE		0x100000
 #define RAMDISK_FLASH_MAXSIZE		0x2000000
-#define UBOOT_FLASH_ADDR		(CONFIG_SYS_FSL_FLASH0_BASE + 0x0)
+#define UBOOT_FLASH_ADDR		CONFIG_SYS_FLASH_BASE
 
-#define KERNEL_FLASH_ADDR	(CONFIG_SYS_FSL_FLASH0_BASE + 0x1f0000)
-#define FDT_FLASH_ADDR	(CONFIG_SYS_FSL_FLASH0_BASE + 0xff0000)
-#define RAMDISK_FLASH_ADDR	(CONFIG_SYS_FSL_FLASH0_BASE + 0x10f0000)
+#define KERNEL_FLASH_ADDR	(CONFIG_SYS_FLASH_BASE + 0x1f0000)
+#define FDT_FLASH_ADDR	(CONFIG_SYS_FLASH_BASE + 0xff0000)
+#define RAMDISK_FLASH_ADDR	(CONFIG_SYS_FLASH_BASE + 0x10f0000)
 
 #if defined(CONFIG_ENV_IS_IN_FLASH) || defined(CONFIG_ENV_IS_IN_SPI_FLASH)
 
 #if defined(CONFIG_ENV_OFFSET)
-#define ENV_FLASH_ADDR	(CONFIG_SYS_FSL_FLASH0_BASE + CONFIG_ENV_OFFSET)
+#define ENV_FLASH_ADDR	(CONFIG_SYS_FLASH_BASE + CONFIG_ENV_OFFSET)
 #else
 #define ENV_FLASH_ADDR	(CONFIG_ENV_ADDR)
 #endif
diff --git a/scripts/config_whitelist.txt b/scripts/config_whitelist.txt
index a03f86551a..7ac0d49bc7 100644
--- a/scripts/config_whitelist.txt
+++ b/scripts/config_whitelist.txt
@@ -2505,10 +2505,6 @@ CONFIG_SYS_FSL_ESDHC_LE
 CONFIG_SYS_FSL_ESDHC_NUM
 CONFIG_SYS_FSL_ESDHC_P1010_BROKEN_SDCLK
 CONFIG_SYS_FSL_ESDHC_USE_PIO
-CONFIG_SYS_FSL_FLASH0_BASE
-CONFIG_SYS_FSL_FLASH0_SIZE
-CONFIG_SYS_FSL_FLASH1_BASE
-CONFIG_SYS_FSL_FLASH1_SIZE
 CONFIG_SYS_FSL_FM
 CONFIG_SYS_FSL_FM1_ADDR
 CONFIG_SYS_FSL_FM1_DTSEC1_ADDR
-- 
2.17.1

