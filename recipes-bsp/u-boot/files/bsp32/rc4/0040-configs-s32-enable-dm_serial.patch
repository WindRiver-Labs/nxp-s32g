From 9e800e8bb0728697e70f35c04326177e98fe65da Mon Sep 17 00:00:00 2001
From: "Radu Pirea (NXP OSS)" <radu-nicolae.pirea@oss.nxp.com>
Date: Mon, 31 Jan 2022 12:33:57 +0200
Subject: [PATCH 40/64] configs: s32: enable dm_serial

Issue: ALB-8368

Upstream-Status: Pending 

Signed-off-by: Radu Pirea (NXP OSS) <radu-nicolae.pirea@oss.nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 board/freescale/Kconfig                 | 2 ++
 configs/s32g274a_emu_defconfig          | 3 ---
 configs/s32g274abluebox3_defconfig      | 1 -
 configs/s32g274abluebox3_qspi_defconfig | 5 +----
 configs/s32g274ardb2_defconfig          | 5 +----
 configs/s32g274ardb2_qspi_defconfig     | 7 ++-----
 configs/s32g2xxaevb_defconfig           | 5 +----
 configs/s32g2xxaevb_qspi_defconfig      | 7 ++-----
 configs/s32g399a_emu_defconfig          | 3 ---
 configs/s32g3xxaevb_defconfig           | 4 +---
 configs/s32g3xxaevb_qspi_defconfig      | 6 ++----
 configs/s32r45_emu_defconfig            | 5 +----
 configs/s32r45evb_defconfig             | 7 ++-----
 configs/s32r45evb_qspi_defconfig        | 5 +----
 14 files changed, 16 insertions(+), 49 deletions(-)

diff --git a/board/freescale/Kconfig b/board/freescale/Kconfig
index ff659390fd..8850a75ee1 100644
--- a/board/freescale/Kconfig
+++ b/board/freescale/Kconfig
@@ -8,6 +8,7 @@ config S32_GEN1
 	imply CMD_CPU
 	imply CMD_GPIO
 	imply CMD_FUSE
+	imply FSL_LINFLEXUART
 	imply ADC if !TARGET_S32G274ARDB
 	imply S32_SARADC if !TARGET_S32G274ARDB
 	imply MISC
@@ -15,6 +16,7 @@ config S32_GEN1
 	select CLK
 	select CLK_SCMI
 	select DM_GPIO
+	select DM_SERIAL
 	select OF_CONTROL
 	select OF_SEPARATE
 	select PINCTRL
diff --git a/configs/s32g274a_emu_defconfig b/configs/s32g274a_emu_defconfig
index fb299954df..dbf0065762 100644
--- a/configs/s32g274a_emu_defconfig
+++ b/configs/s32g274a_emu_defconfig
@@ -5,7 +5,6 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G274AEMU=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
@@ -23,5 +22,3 @@ CONFIG_DM=y
 # CONFIG_DM_SEQ_ALIAS is not set
 CONFIG_DM_MMC=y
 CONFIG_FSL_USDHC=y
-CONFIG_FSL_LINFLEXUART=y
-CONFIG_FSL_LINFLEX_MODULE=1
diff --git a/configs/s32g274abluebox3_defconfig b/configs/s32g274abluebox3_defconfig
index 22440537f3..b6717def8d 100644
--- a/configs/s32g274abluebox3_defconfig
+++ b/configs/s32g274abluebox3_defconfig
@@ -52,7 +52,6 @@ CONFIG_PCIE_S32GEN1=y
 CONFIG_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
diff --git a/configs/s32g274abluebox3_qspi_defconfig b/configs/s32g274abluebox3_qspi_defconfig
index 96e908aa55..a5edfc7598 100644
--- a/configs/s32g274abluebox3_qspi_defconfig
+++ b/configs/s32g274abluebox3_qspi_defconfig
@@ -1,4 +1,3 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x10000
@@ -8,9 +7,9 @@ CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G274ABLUEBOX3=y
 # CONFIG_S32GEN1_DRAM_INLINE_ECC is not set
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_ARCH_EARLY_INIT_R=y
 CONFIG_BOARD_EARLY_INIT_R=y
@@ -38,7 +37,6 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
-CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
@@ -59,7 +57,6 @@ CONFIG_PCIE_S32GEN1=y
 CONFIG_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
diff --git a/configs/s32g274ardb2_defconfig b/configs/s32g274ardb2_defconfig
index e8ec328d83..99224f2990 100644
--- a/configs/s32g274ardb2_defconfig
+++ b/configs/s32g274ardb2_defconfig
@@ -3,9 +3,7 @@ CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x2000
 CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
-CONFIG_TARGET_S32G274ARDB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
 CONFIG_SD_BOOT=y
@@ -31,6 +29,7 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
+CONFIG_SJA1105=y
 CONFIG_DM_MMC=y
 CONFIG_FSL_USDHC=y
 CONFIG_DM_SPI_FLASH=y
@@ -55,10 +54,8 @@ CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
 CONFIG_DM_PMIC_PF5020=y
 CONFIG_DM_PMIC_FS5600=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 # CONFIG_EFI_LOADER is not set
diff --git a/configs/s32g274ardb2_qspi_defconfig b/configs/s32g274ardb2_qspi_defconfig
index 0e63482030..1345c0ad44 100644
--- a/configs/s32g274ardb2_qspi_defconfig
+++ b/configs/s32g274ardb2_qspi_defconfig
@@ -1,15 +1,13 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x10000
 CONFIG_ENV_SECT_SIZE=0x10000
 CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
-CONFIG_TARGET_S32G274ARDB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_BOOTARGS="root=/dev/ram rw earlycon"
 CONFIG_BOARD_LATE_INIT=y
@@ -36,6 +34,7 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
+CONFIG_SJA1105=y
 CONFIG_DM_MMC=y
 CONFIG_FSL_USDHC=y
 CONFIG_DM_SPI_FLASH=y
@@ -60,10 +59,8 @@ CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
 CONFIG_DM_PMIC_PF5020=y
 CONFIG_DM_PMIC_FS5600=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 # CONFIG_EFI_LOADER is not set
diff --git a/configs/s32g2xxaevb_defconfig b/configs/s32g2xxaevb_defconfig
index 1740a66c61..fe856309d0 100644
--- a/configs/s32g2xxaevb_defconfig
+++ b/configs/s32g2xxaevb_defconfig
@@ -5,7 +5,6 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G2XXAEVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
 CONFIG_SD_BOOT=y
@@ -31,8 +30,8 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
-CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
+CONFIG_SJA1105=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
 CONFIG_DM_MMC=y
@@ -59,12 +58,10 @@ CONFIG_PHY=y
 CONFIG_SAF1508BET_USB_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 CONFIG_USB=y
 CONFIG_DM_USB=y
 CONFIG_USB_EHCI_HCD=y
diff --git a/configs/s32g2xxaevb_qspi_defconfig b/configs/s32g2xxaevb_qspi_defconfig
index 96f91c74ee..9ee798a8c0 100644
--- a/configs/s32g2xxaevb_qspi_defconfig
+++ b/configs/s32g2xxaevb_qspi_defconfig
@@ -1,4 +1,3 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x10000
@@ -7,9 +6,9 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G2XXAEVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_BOOTARGS="root=/dev/ram rw earlycon"
 CONFIG_ARCH_EARLY_INIT_R=y
@@ -36,8 +35,8 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
-CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
+CONFIG_SJA1105=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
 CONFIG_DM_MMC=y
@@ -64,12 +63,10 @@ CONFIG_PHY=y
 CONFIG_SAF1508BET_USB_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 CONFIG_USB=y
 CONFIG_DM_USB=y
 CONFIG_USB_EHCI_HCD=y
diff --git a/configs/s32g399a_emu_defconfig b/configs/s32g399a_emu_defconfig
index 333567744d..8c64361f72 100644
--- a/configs/s32g399a_emu_defconfig
+++ b/configs/s32g399a_emu_defconfig
@@ -5,7 +5,6 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G399AEMU=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
@@ -23,5 +22,3 @@ CONFIG_DM=y
 # CONFIG_DM_SEQ_ALIAS is not set
 CONFIG_DM_MMC=y
 CONFIG_FSL_USDHC=y
-CONFIG_FSL_LINFLEXUART=y
-CONFIG_FSL_LINFLEX_MODULE=1
diff --git a/configs/s32g3xxaevb_defconfig b/configs/s32g3xxaevb_defconfig
index 0229347c99..5a4915fae3 100644
--- a/configs/s32g3xxaevb_defconfig
+++ b/configs/s32g3xxaevb_defconfig
@@ -5,7 +5,6 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G3XXAEVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
 CONFIG_SD_BOOT=y
@@ -32,6 +31,7 @@ CONFIG_DM=y
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
 CONFIG_I2C_EEPROM=y
+CONFIG_SJA1105=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
 CONFIG_DM_MMC=y
@@ -58,12 +58,10 @@ CONFIG_PHY=y
 CONFIG_SAF1508BET_USB_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 CONFIG_USB=y
 CONFIG_DM_USB=y
 CONFIG_USB_EHCI_HCD=y
diff --git a/configs/s32g3xxaevb_qspi_defconfig b/configs/s32g3xxaevb_qspi_defconfig
index 990861b98f..c0a224a8fe 100644
--- a/configs/s32g3xxaevb_qspi_defconfig
+++ b/configs/s32g3xxaevb_qspi_defconfig
@@ -1,4 +1,3 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x10000
@@ -7,9 +6,9 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32G3XXAEVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_BOOTARGS="root=/dev/ram rw earlycon"
 CONFIG_ARCH_EARLY_INIT_R=y
@@ -38,6 +37,7 @@ CONFIG_DM=y
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
 CONFIG_I2C_EEPROM=y
+CONFIG_SJA1105=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
 CONFIG_DM_MMC=y
@@ -64,12 +64,10 @@ CONFIG_PHY=y
 CONFIG_SAF1508BET_USB_PHY=y
 CONFIG_DM_PMIC=y
 CONFIG_DM_PMIC_VR5510=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
-CONFIG_SJA1105=y
 CONFIG_USB=y
 CONFIG_DM_USB=y
 CONFIG_USB_EHCI_HCD=y
diff --git a/configs/s32r45_emu_defconfig b/configs/s32r45_emu_defconfig
index 2cfdf5d6fc..c7477498d6 100644
--- a/configs/s32r45_emu_defconfig
+++ b/configs/s32r45_emu_defconfig
@@ -1,14 +1,13 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x2000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32R45EMU=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_BOOTARGS="root=/dev/ram rw earlycon loglevel=7"
 CONFIG_ARCH_EARLY_INIT_R=y
@@ -16,7 +15,5 @@ CONFIG_CMD_MEMTEST=y
 CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 # CONFIG_DM_SEQ_ALIAS is not set
-CONFIG_FSL_LINFLEXUART=y
-CONFIG_FSL_LINFLEX_MODULE=1
 CONFIG_SPI=y
 CONFIG_FSL_DSPI=y
diff --git a/configs/s32r45evb_defconfig b/configs/s32r45evb_defconfig
index 3e0cd53331..fcd0786dbb 100644
--- a/configs/s32r45evb_defconfig
+++ b/configs/s32r45evb_defconfig
@@ -5,7 +5,6 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32R45EVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
@@ -32,7 +31,6 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
-CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
@@ -41,6 +39,8 @@ CONFIG_FSL_USDHC=y
 CONFIG_DM_SPI_FLASH=y
 # CONFIG_SPI_FLASH_BAR is not set
 CONFIG_SPI_FLASH_MACRONIX=y
+CONFIG_PHY_AQUANTIA=y
+CONFIG_PHY_FIXED=y
 CONFIG_DM_ETH=y
 CONFIG_DWC_ETH_QOS_DEVICES=y
 CONFIG_DWC_ETH_QOS_S32CC=y
@@ -49,11 +49,8 @@ CONFIG_CMD_E1000=y
 CONFIG_PCI=y
 CONFIG_DM_PCI=y
 CONFIG_PCIE_S32GEN1=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
 CONFIG_FSL_QSPI=y
 # CONFIG_EFI_LOADER is not set
-CONFIG_PHY_FIXED=y
-CONFIG_PHY_AQUANTIA=y
diff --git a/configs/s32r45evb_qspi_defconfig b/configs/s32r45evb_qspi_defconfig
index d3e1051e6f..cdbf9aec34 100644
--- a/configs/s32r45evb_qspi_defconfig
+++ b/configs/s32r45evb_qspi_defconfig
@@ -1,4 +1,3 @@
-CONFIG_QSPI_BOOT=y
 CONFIG_ARM=y
 CONFIG_ARCH_S32=y
 CONFIG_ENV_SIZE=0x10000
@@ -7,10 +6,10 @@ CONFIG_ENV_OFFSET=0x1e0000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_TARGET_S32R45EVB=y
 CONFIG_DISTRO_DEFAULTS=y
-# CONFIG_SYS_MALLOC_F is not set
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
 CONFIG_TOOLS_DEBUG=y
 CONFIG_FIT=y
+CONFIG_QSPI_BOOT=y
 CONFIG_USE_BOOTARGS=y
 CONFIG_BOOTARGS="root=/dev/ram rw earlycon loglevel=7"
 CONFIG_ARCH_EARLY_INIT_R=y
@@ -36,7 +35,6 @@ CONFIG_DM=y
 # CONFIG_DM_DEVICE_REMOVE is not set
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_MXC=y
-CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
 CONFIG_SYS_EEPROM_SIZE=128
 CONFIG_SYS_EEPROM_PAGE_WRITE_DELAY_MS=10
@@ -53,7 +51,6 @@ CONFIG_CMD_E1000=y
 CONFIG_PCI=y
 CONFIG_DM_PCI=y
 CONFIG_PCIE_S32GEN1=y
-CONFIG_FSL_LINFLEXUART=y
 CONFIG_SPI=y
 CONFIG_DM_SPI=y
 CONFIG_FSL_DSPI=y
-- 
2.17.1

