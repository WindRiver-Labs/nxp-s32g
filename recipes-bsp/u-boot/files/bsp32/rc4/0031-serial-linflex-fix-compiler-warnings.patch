From 88ab00b02ba9b4ceb30eea721d95aa62d34abb8c Mon Sep 17 00:00:00 2001
From: "Radu Pirea (NXP OSS)" <radu-nicolae.pirea@oss.nxp.com>
Date: Mon, 31 Jan 2022 12:05:08 +0200
Subject: [PATCH 31/64] serial: linflex: fix compiler warnings

Issue: ALB-8368

Upstream-Status: Pending 

Signed-off-by: Radu Pirea (NXP OSS) <radu-nicolae.pirea@oss.nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 drivers/serial/serial_linflexuart.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

diff --git a/drivers/serial/serial_linflexuart.c b/drivers/serial/serial_linflexuart.c
index 47593803bd..2c212adeb6 100644
--- a/drivers/serial/serial_linflexuart.c
+++ b/drivers/serial/serial_linflexuart.c
@@ -71,7 +71,7 @@ static void _linflex_serial_setbrg(struct linflex_fsl *base, int baudrate)
 
 static int _linflex_serial_getc(struct linflex_fsl *base)
 {
-	while (__raw_readl(&base->uartsr) & UARTSR_RFE == UARTSR_RFE)
+	while ((__raw_readl(&base->uartsr) & UARTSR_RFE) == UARTSR_RFE)
 		;
 
 	return __raw_readb(&base->bdrm);
@@ -84,6 +84,8 @@ static int _linflex_serial_putc(struct linflex_fsl *base, const char c)
 		;
 
 	__raw_writeb(c, &base->bdrl);
+
+	return 0;
 }
 
 /*
@@ -168,11 +170,13 @@ static int linflex_serial_pending(struct udevice *dev, bool input)
 static int linflex_serial_probe(struct udevice *dev)
 {
 	struct linflex_serial_priv *priv = dev_get_priv(dev);
+	fdt_addr_t base_addr;
 
-	priv->lfuart = (struct linflex_fsl *)devfdt_get_addr(dev);
-	if (priv->lfuart == FDT_ADDR_T_NONE)
+	base_addr = devfdt_get_addr(dev);
+	if (base_addr == FDT_ADDR_T_NONE)
 		return -EINVAL;
 
+	priv->lfuart = (struct linflex_fsl *)base_addr;
 	_linflex_serial_init(priv->lfuart);
 
 	return 0;
-- 
2.17.1

